source("CommonFunctions.R")
library(ggplot2)
library(deSolve)
# Parameters.
# Divide all rates to get rate per 4.5 minutes, which is 1/10th of the lysis time.
multiplier = 1/13.3
V_U = 1.68244586132173*multiplier
V_L = 0.841222930660867*multiplier
H = 2.70324295196332e-08
e = 4.38281752570703e-12
D_b = 0.00248293274733681*multiplier
eta = 0
r = 0.000239052576352519*multiplier
K_a = 2.06338181565078e-08*multiplier
D_p = 1e-07*multiplier
beta = 208.271099881042
d = 0*multiplier
i = 1.14730635311557e-09*multiplier
R_0 = i
h=1.00
K=1.814
out = data.frame()
# Solve the ODEs (at this point, every 1 on the x-axis refers to 4.5 minutes.)
times <- seq(0,to=10000/multiplier,by=1)
initials <- c(U=1, R=R_0/multiplier, P=1, L=0)
out_1 = as.data.frame(ode(func=f, y=initials, parms =c(MOI=1),times = times))
out <- rbind(out, out_1)
# Convert the x-axis back into hours.
out$time = out$time * multiplier
# Make the plots.
ggplot(out, aes(time))+geom_line(aes(y=U/1000, color='Uninfected')) + geom_line(aes(y=L/1000, color='Lysogens'))+labs(title='Uninfected and Lysogen Concentration vs Time', x='Time (hr)', y='Bacterial Concentration (x 1000 bacteria/mL)') +theme_bw()
ggplot(out, aes(time))+geom_line(aes(y=P/100000, color='Phage'),color='GREEN') +labs(title='Phage Concentration vs Time', x='Time (hr)', y='Phage Concentration (x 100000 phages/mL)')  +theme_bw()
ggplot(out, aes(time))+geom_line(aes(y=R*1e+9, color='Resource'),color='PURPLE') +labs(title='Resource Concentration vs Time', x='Time (hr)', y='Glucose Concentration (ng/mL)') + coord_trans(y="log10")+ theme_bw()
ggplot(out, aes(time))+geom_line(aes(y=phi_moi(K_a,P,h,K), color='Probability of Lysogeny'),color='MAGENTA') +labs(title='Probability of Lysogeny vs Time', x='Time (hr)', y='Probability of Lysogeny')+ theme_bw()
# The probability of lysogeny for 1e+9 bacteria/mL.
print(phi_moi(K_a, 1e+9,h,K))
library("deSolve")
library("ggplot2")
lognormal_converter <- function(lower, upper){
ln_lower = log(lower)
ln_upper = log(upper)
ln_mean = (log(lower)+log(upper))/2
ln_sd = (ln_upper-ln_mean)/2
return(c(mu=ln_mean, sigma=ln_sd))
}
latent_period = 4.5
multiplier = 1
params_V_U = lognormal_converter(0.5, 10)
V_U = rlnorm(1, params_V_U[1], params_V_U[2])*multiplier
params_H = lognormal_converter(15e-9, 35e-9)
H = rlnorm(1, params_H[1], params_H[2])
V_L = V_U/2 # arbitrarily chosen, but lower than V_U
params_e = lognormal_converter(5.98e-13, 5.4e-12)
e = rlnorm(1, params_e[1], params_e[2])
params_D_b = lognormal_converter(1e-4, 1e-2)
D_b = rlnorm(1, params_D_b[1], params_D_b[2])*multiplier
eta = 0
params_phi = lognormal_converter(1e-5, 1e-1)
phi = rlnorm(1, params_phi[1], params_phi[2])
params_r = lognormal_converter(1e-4, 1e-3)
r = rlnorm(1, params_r[1], params_r[2])*multiplier
params_K_a = lognormal_converter(4.46e-9, 6.18e-7)
K_a = rlnorm(1, params_K_a[1], params_K_a[2])*multiplier
D_p = 1e-7#0*multiplier
params_beta = lognormal_converter(20, 1000)
beta = rlnorm(1, params_beta[1], params_beta[2])
params_d = lognormal_converter(1e-4, 0.35)
d = 0.0#rlnorm(1, params_d[1], params_d[2])*multiplier #10 ** runif(1, -4, -1)
params_i = lognormal_converter(4.8e-10, 4.8e-9)
i = rlnorm(1, params_i[1], params_i[2])*multiplier #4.8e-9 #maybe vary this one
R_0 = i
for (x in c(paste('V_U = ', V_U, sep=''), paste('V_L = ', V_L, sep=''),paste('H = ', H, sep=''),paste('e = ', e, sep=''), paste('D_b = ', D_b, sep=''),paste('eta = ', eta, sep=''),paste('phi = ', phi, sep=''),paste('r = ', r, sep=''),paste('K_a = ', K_a, sep=''),paste('D_p = ', D_p, sep=''),paste('beta = ', beta, sep=''),paste('d = ', d, sep=''),paste('i = ', i, sep=''))){
print(x)
}
lognormal_converter <- function(lower, upper){
ln_lower = log(lower)
ln_upper = log(upper)
ln_mean = (log(lower)+log(upper))/2
ln_sd = (ln_upper-ln_mean)/2
return(c(mu=ln_mean, sigma=ln_sd))
}
latent_period = 4.5
multiplier = 1
params_V_U = lognormal_converter(0.5, 10)
V_U = rlnorm(1, params_V_U[1], params_V_U[2])*multiplier
params_H = lognormal_converter(15e-9, 35e-9)
H = rlnorm(1, params_H[1], params_H[2])
V_L = V_U/2 # arbitrarily chosen, but lower than V_U
params_e = lognormal_converter(5.98e-13, 5.4e-12)
e = rlnorm(1, params_e[1], params_e[2])
params_D_b = lognormal_converter(1e-4, 1e-2)
D_b = rlnorm(1, params_D_b[1], params_D_b[2])*multiplier
eta = 0
params_phi = lognormal_converter(1e-5, 1e-1)
phi = rlnorm(1, params_phi[1], params_phi[2])
params_r = lognormal_converter(1e-4, 1e-3)
r = rlnorm(1, params_r[1], params_r[2])*multiplier
params_K_a = lognormal_converter(4.46e-9, 6.18e-7)
K_a = rlnorm(1, params_K_a[1], params_K_a[2])*multiplier
D_p = 1e-7#0*multiplier
params_beta = lognormal_converter(20, 1000)
beta = rlnorm(1, params_beta[1], params_beta[2])
params_d = lognormal_converter(1e-4, 0.35)
d = 0.0#rlnorm(1, params_d[1], params_d[2])*multiplier #10 ** runif(1, -4, -1)
params_i = lognormal_converter(4.8e-10, 4.8e-9)
i = rlnorm(1, params_i[1], params_i[2])*multiplier #4.8e-9 #maybe vary this one
R_0 = i
for (x in c(paste('V_U = ', V_U, sep=''), paste('V_L = ', V_L, sep=''),paste('H = ', H, sep=''),paste('e = ', e, sep=''), paste('D_b = ', D_b, sep=''),paste('eta = ', eta, sep=''),paste('phi = ', phi, sep=''),paste('r = ', r, sep=''),paste('K_a = ', K_a, sep=''),paste('D_p = ', D_p, sep=''),paste('beta = ', beta, sep=''),paste('d = ', d, sep=''),paste('i = ', i, sep=''))){
print(x)
}
lognormal_converter <- function(lower, upper){
ln_lower = log(lower)
ln_upper = log(upper)
ln_mean = (log(lower)+log(upper))/2
ln_sd = (ln_upper-ln_mean)/2
return(c(mu=ln_mean, sigma=ln_sd))
}
latent_period = 4.5
multiplier = 1
params_V_U = lognormal_converter(0.5, 10)
V_U = rlnorm(1, params_V_U[1], params_V_U[2])*multiplier
params_H = lognormal_converter(15e-9, 35e-9)
H = rlnorm(1, params_H[1], params_H[2])
V_L = V_U/2
params_e = lognormal_converter(5.98e-13, 5.4e-12)
e = rlnorm(1, params_e[1], params_e[2])
params_D_b = lognormal_converter(1e-4, 1e-2)
D_b = rlnorm(1, params_D_b[1], params_D_b[2])*multiplier
eta = 0
params_phi = lognormal_converter(1e-5, 1e-1)
phi = rlnorm(1, params_phi[1], params_phi[2])
params_r = lognormal_converter(1e-4, 1e-3)
r = rlnorm(1, params_r[1], params_r[2])*multiplier
params_K_a = lognormal_converter(4.46e-9, 6.18e-7)
K_a = rlnorm(1, params_K_a[1], params_K_a[2])*multiplier
D_p = 1e-7
params_beta = lognormal_converter(20, 1000)
beta = rlnorm(1, params_beta[1], params_beta[2])
params_d = lognormal_converter(1e-4, 0.35)
d = 0.0
params_i = lognormal_converter(4.8e-10, 4.8e-9)
i = rlnorm(1, params_i[1], params_i[2])*multiplier
R_0 = i
for (x in c(paste('V_U = ', V_U, sep=''), paste('V_L = ', V_L, sep=''),paste('H = ', H, sep=''),paste('e = ', e, sep=''), paste('D_b = ', D_b, sep=''),paste('eta = ', eta, sep=''),paste('phi = ', phi, sep=''),paste('r = ', r, sep=''),paste('K_a = ', K_a, sep=''),paste('D_p = ', D_p, sep=''),paste('beta = ', beta, sep=''),paste('d = ', d, sep=''),paste('i = ', i, sep=''))){
cat(x)
}
lognormal_converter <- function(lower, upper){
ln_lower = log(lower)
ln_upper = log(upper)
ln_mean = (log(lower)+log(upper))/2
ln_sd = (ln_upper-ln_mean)/2
return(c(mu=ln_mean, sigma=ln_sd))
}
latent_period = 4.5
multiplier = 1
params_V_U = lognormal_converter(0.5, 10)
V_U = rlnorm(1, params_V_U[1], params_V_U[2])*multiplier
params_H = lognormal_converter(15e-9, 35e-9)
H = rlnorm(1, params_H[1], params_H[2])
V_L = V_U/2
params_e = lognormal_converter(5.98e-13, 5.4e-12)
e = rlnorm(1, params_e[1], params_e[2])
params_D_b = lognormal_converter(1e-4, 1e-2)
D_b = rlnorm(1, params_D_b[1], params_D_b[2])*multiplier
eta = 0
params_phi = lognormal_converter(1e-5, 1e-1)
phi = rlnorm(1, params_phi[1], params_phi[2])
params_r = lognormal_converter(1e-4, 1e-3)
r = rlnorm(1, params_r[1], params_r[2])*multiplier
params_K_a = lognormal_converter(4.46e-9, 6.18e-7)
K_a = rlnorm(1, params_K_a[1], params_K_a[2])*multiplier
D_p = 1e-7
params_beta = lognormal_converter(20, 1000)
beta = rlnorm(1, params_beta[1], params_beta[2])
params_d = lognormal_converter(1e-4, 0.35)
d = 0.0
params_i = lognormal_converter(4.8e-10, 4.8e-9)
i = rlnorm(1, params_i[1], params_i[2])*multiplier
R_0 = i
for (x in c(paste('V_U = ', V_U, sep=''), paste('V_L = ', V_L, sep=''),paste('H = ', H, sep=''),paste('e = ', e, sep=''), paste('D_b = ', D_b, sep=''),paste('eta = ', eta, sep=''),paste('phi = ', phi, sep=''),paste('r = ', r, sep=''),paste('K_a = ', K_a, sep=''),paste('D_p = ', D_p, sep=''),paste('beta = ', beta, sep=''),paste('d = ', d, sep=''),paste('i = ', i, sep=''))){
cat(x + '\n')
}
lognormal_converter <- function(lower, upper){
ln_lower = log(lower)
ln_upper = log(upper)
ln_mean = (log(lower)+log(upper))/2
ln_sd = (ln_upper-ln_mean)/2
return(c(mu=ln_mean, sigma=ln_sd))
}
latent_period = 4.5
multiplier = 1
params_V_U = lognormal_converter(0.5, 10)
V_U = rlnorm(1, params_V_U[1], params_V_U[2])*multiplier
params_H = lognormal_converter(15e-9, 35e-9)
H = rlnorm(1, params_H[1], params_H[2])
V_L = V_U/2
params_e = lognormal_converter(5.98e-13, 5.4e-12)
e = rlnorm(1, params_e[1], params_e[2])
params_D_b = lognormal_converter(1e-4, 1e-2)
D_b = rlnorm(1, params_D_b[1], params_D_b[2])*multiplier
eta = 0
params_phi = lognormal_converter(1e-5, 1e-1)
phi = rlnorm(1, params_phi[1], params_phi[2])
params_r = lognormal_converter(1e-4, 1e-3)
r = rlnorm(1, params_r[1], params_r[2])*multiplier
params_K_a = lognormal_converter(4.46e-9, 6.18e-7)
K_a = rlnorm(1, params_K_a[1], params_K_a[2])*multiplier
D_p = 1e-7
params_beta = lognormal_converter(20, 1000)
beta = rlnorm(1, params_beta[1], params_beta[2])
params_d = lognormal_converter(1e-4, 0.35)
d = 0.0
params_i = lognormal_converter(4.8e-10, 4.8e-9)
i = rlnorm(1, params_i[1], params_i[2])*multiplier
R_0 = i
for (x in c(paste('V_U = ', V_U, sep=''), paste('V_L = ', V_L, sep=''),paste('H = ', H, sep=''),paste('e = ', e, sep=''), paste('D_b = ', D_b, sep=''),paste('eta = ', eta, sep=''),paste('phi = ', phi, sep=''),paste('r = ', r, sep=''),paste('K_a = ', K_a, sep=''),paste('D_p = ', D_p, sep=''),paste('beta = ', beta, sep=''),paste('d = ', d, sep=''),paste('i = ', i, sep=''))){
cat(paste(x,'\n'))
}
# Converts parameter range to lognormal mean and sd.
lognormal_converter <- function(lower, upper){
ln_lower = log(lower)
ln_upper = log(upper)
ln_mean = (log(lower)+log(upper))/2
ln_sd = (ln_upper-ln_mean)/2
return(c(mu=ln_mean, sigma=ln_sd))
}
parameter_generator <- function(){
params_V_U = lognormal_converter(0.5, 10)
V_U = rlnorm(1, params_V_U[1], params_V_U[2])*multiplier
params_H = lognormal_converter(15e-9, 35e-9)
H = rlnorm(1, params_H[1], params_H[2])
V_L = V_U/2
params_e = lognormal_converter(5.98e-13, 5.4e-12)
e = rlnorm(1, params_e[1], params_e[2])
params_D_b = lognormal_converter(1e-4, 1e-2)
D_b = rlnorm(1, params_D_b[1], params_D_b[2])*multiplier
eta = 0
params_phi = lognormal_converter(1e-5, 1e-1)
phi = rlnorm(1, params_phi[1], params_phi[2])
params_r = lognormal_converter(1e-4, 1e-3)
r = rlnorm(1, params_r[1], params_r[2])*multiplier
params_K_a = lognormal_converter(4.46e-9, 6.18e-7)
K_a = rlnorm(1, params_K_a[1], params_K_a[2])*multiplier
D_p = 1e-7
params_beta = lognormal_converter(20, 1000)
beta = rlnorm(1, params_beta[1], params_beta[2])
params_d = lognormal_converter(1e-4, 0.35)
d = 0.0
params_i = lognormal_converter(4.8e-10, 4.8e-9)
i = rlnorm(1, params_i[1], params_i[2])*multiplier
R_0 = i
# Print parameters.
for (x in c(paste('V_U = ', V_U, sep=''), paste('V_L = ', V_L, sep=''),paste('H = ', H, sep=''),paste('e = ', e, sep=''), paste('D_b = ', D_b, sep=''),paste('eta = ', eta, sep=''),paste('phi = ', phi, sep=''),paste('r = ', r, sep=''),paste('K_a = ', K_a, sep=''),paste('D_p = ', D_p, sep=''),paste('beta = ', beta, sep=''),paste('d = ', d, sep=''),paste('i = ', i, sep=''))){
cat(paste(x,'\n'))
}
return(c(V_U=V_U, V_L=V_L, H=H, e=e, D_b = D_b, eta = eta, phi=phi, r=r, K_a=K_a, D_p = D_p, beta, d, i))
}
parameter_generator()
